"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getUrlHash = exports.getUrlAndDataHashes = exports.getUDatagram = exports.getDataHash = void 0;
const crypto_1 = require("crypto");
// '73B439CEB0EBEF90782E9978FEEBF88AA1540C763CAEDABA5B16223D306437E0'.length;
function getUrlHash(urlPath) {
    const HEX = 'hex';
    return {
        URL_HSH: !urlPath
            ? 'null'
            : `URL:${crypto_1.createHash('sha256')
                .update(urlPath)
                .digest(HEX)
                .toUpperCase()
                .slice(0, 18)}`,
        path: !urlPath ? 'null' : urlPath,
    };
}
exports.getUrlHash = getUrlHash;
function getDataHash(dataToHash) {
    const HEX = 'hex';
    return {
        DATA_HSH: !dataToHash
            ? 'null'
            : `DATA:${crypto_1.createHash('sha256')
                .update(JSON.stringify(dataToHash))
                .digest(HEX)
                .toUpperCase()
                .slice(0, 16)}`,
        data: !dataToHash ? 'null' : dataToHash,
    };
}
exports.getDataHash = getDataHash;
function getUDatagram(urlPath, dataToHash) {
    const HEX = 'hex';
    return {
        UDATAGRAM: `UDATAGRAM:${crypto_1.createHash('sha256')
            .update(`${!dataToHash
            ? 'null'
            : `DATA:${crypto_1.createHash('sha256')
                .update(JSON.stringify(dataToHash))
                .digest(HEX)
                .toUpperCase()}`}${!urlPath
            ? 'null'
            : `URL:${crypto_1.createHash('sha256')
                .update(urlPath)
                .digest(HEX)
                .toUpperCase()}`}`)
            .digest(HEX)
            .toUpperCase()
            .slice(0, 15)}`,
    };
}
exports.getUDatagram = getUDatagram;
function getUrlAndDataHashes(urlPath = '', dataToCache) {
    // const BASE64: BinaryToTextEncoding = 'base64';
    const HEX = 'hex';
    return {
        DATA_HSH: !dataToCache
            ? 'null'
            : `DATA:${crypto_1.createHash('sha256')
                .update(JSON.stringify(dataToCache))
                .digest(HEX)
                .toUpperCase()
                .slice(0, 16)}`,
        UDATAGRAM: `UDATAGRAM:${crypto_1.createHash('sha256')
            .update(`${!dataToCache
            ? 'null'
            : `DATA:${crypto_1.createHash('sha256')
                .update(JSON.stringify(dataToCache))
                .digest(HEX)
                .toUpperCase()}`}${!urlPath
            ? 'null'
            : `URL:${crypto_1.createHash('sha256')
                .update(urlPath)
                .digest(HEX)
                .toUpperCase()}`}`)
            .digest(HEX)
            .toUpperCase()
            .slice(0, 15)}`,
        URL_HSH: !urlPath
            ? 'null'
            : `URL:${crypto_1.createHash('sha256')
                .update(urlPath)
                .digest(HEX)
                .toUpperCase()
                .slice(0, 18)}`,
        dataToCache: !dataToCache ? 'null' : dataToCache,
        path: !urlPath ? 'null' : urlPath,
    };
}
exports.getUrlAndDataHashes = getUrlAndDataHashes;
// dATA_HASH_B62: !dataToHash
//   ? 'null'
//   : `DATA:B62${createHash('sha256')
//       .update(JSON.stringify(dataToHash))
//       .digest(BASE64)
//       .replaceAll('+', '')
//       .replaceAll('/', '')
//       .replaceAll('=', '')
//       .slice(0, 8)}`,
// uRL_HASH_B62: !urlPath
//   ? 'null'
//   : `URL:B62:${createHash('sha256')
//       .update(urlPath)
//       .digest(BASE64)
//       .replaceAll('+', '')
//       .replaceAll('/', '')
//       .replaceAll('=', '')
//       .slice(0, 8)}`,
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRlLXVybC1hbmQtZGF0YS1oYXNoZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvdXRpbHMvY3JlYXRlLXVybC1hbmQtZGF0YS1oYXNoZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQ0EsbUNBQW9DO0FBSXBDLDZFQUE2RTtBQUM3RSxTQUFTLFVBQVUsQ0FBQyxPQUFlO0lBQ2pDLE1BQU0sR0FBRyxHQUF5QixLQUFLLENBQUM7SUFFeEMsT0FBTztRQUNMLE9BQU8sRUFBRSxDQUFDLE9BQU87WUFDZixDQUFDLENBQUMsTUFBTTtZQUNSLENBQUMsQ0FBQyxPQUFPLG1CQUFVLENBQUMsUUFBUSxDQUFDO2lCQUN4QixNQUFNLENBQUMsT0FBTyxDQUFDO2lCQUNmLE1BQU0sQ0FBQyxHQUFHLENBQUM7aUJBQ1gsV0FBVyxFQUFFO2lCQUNiLEtBQUssQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLEVBQUU7UUFDckIsSUFBSSxFQUFFLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLE9BQU87S0FDbEMsQ0FBQztBQUNKLENBQUM7QUE2RndELGdDQUFVO0FBM0ZuRSxTQUFTLFdBQVcsQ0FBQyxVQUFrQjtJQUNyQyxNQUFNLEdBQUcsR0FBeUIsS0FBSyxDQUFDO0lBRXhDLE9BQU87UUFDTCxRQUFRLEVBQUUsQ0FBQyxVQUFVO1lBQ25CLENBQUMsQ0FBQyxNQUFNO1lBQ1IsQ0FBQyxDQUFDLFFBQVEsbUJBQVUsQ0FBQyxRQUFRLENBQUM7aUJBQ3pCLE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxDQUFDO2lCQUNsQyxNQUFNLENBQUMsR0FBRyxDQUFDO2lCQUNYLFdBQVcsRUFBRTtpQkFDYixLQUFLLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxFQUFFO1FBQ3JCLElBQUksRUFBRSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FB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QUV2RCw2QkFBNkI7QUFDN0IsYUFBYTtBQUNiLHNDQUFzQztBQUN0Qyw0Q0FBNEM7QUFDNUMsd0JBQXdCO0FBQ3hCLDZCQUE2QjtBQUM3Qiw2QkFBNkI7QUFDN0IsNkJBQTZCO0FBQzdCLHdCQUF3QjtBQUV4Qix5QkFBeUI7QUFDekIsYUFBYTtBQUNiLHNDQUFzQztBQUN0Qyx5QkFBeUI7QUFDekIsd0JBQXdCO0FBQ3hCLDZCQUE2QjtBQUM3Qiw2QkFBNkI7QUFDN0IsNkJBQTZCO0FBQzdCLHdCQUF3QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgQmluYXJ5VG9UZXh0RW5jb2RpbmcgfSBmcm9tICdjcnlwdG8nO1xuaW1wb3J0IHsgY3JlYXRlSGFzaCB9IGZyb20gJ2NyeXB0byc7XG5cbmltcG9ydCB0eXBlIHsgVXJsRGF0YUFuZEhhc2hlcyB9IGZyb20gJy4uL3R5cGVzY3JpcHQnO1xuXG4vLyAnNzNCNDM5Q0VCMEVCRUY5MDc4MkU5OTc4RkVFQkY4OEFBMTU0MEM3NjNDQUVEQUJBNUIxNjIyM0QzMDY0MzdFMCcubGVuZ3RoO1xuZnVuY3Rpb24gZ2V0VXJsSGFzaCh1cmxQYXRoOiBzdHJpbmcpIHtcbiAgY29uc3QgSEVYOiBCaW5hcnlUb1RleHRFbmNvZGluZyA9ICdoZXgnO1xuXG4gIHJldHVybiB7XG4gICAgVVJMX0hTSDogIXVybFBhdGhcbiAgICAgID8gJ251bGwnXG4gICAgICA6IGBVUkw6JHtjcmVhdGVIYXNoKCdzaGEyNTYnKVxuICAgICAgICAgIC51cGRhdGUodXJsUGF0aClcbiAgICAgICAgICAuZGlnZXN0KEhFWClcbiAgICAgICAgICAudG9VcHBlckNhc2UoKVxuICAgICAgICAgIC5zbGljZSgwLCAxOCl9YCxcbiAgICBwYXRoOiAhdXJsUGF0aCA/ICdudWxsJyA6IHVybFBhdGgsXG4gIH07XG59XG5cbmZ1bmN0aW9uIGdldERhdGFIYXNoKGRhdGFUb0hhc2g6IHN0cmluZykge1xuICBjb25zdCBIRVg6IEJpbmFyeVRvVGV4dEVuY29kaW5nID0gJ2hleCc7XG5cbiAgcmV0dXJuIHtcbiAgICBEQVRBX0hTSDogIWRhdGFUb0hhc2hcbiAgICAgID8gJ251bGwnXG4gICAgICA6IGBEQVRBOiR7Y3JlYXRlSGFzaCgnc2hhMjU2JylcbiAgICAgICAgICAudXBkYXRlKEpTT04uc3RyaW5naWZ5KGRhdGFUb0hhc2gpKVxuICAgICAgICAgIC5kaWdlc3QoSEVYKVxuICAgICAgICAgIC50b1VwcGVyQ2FzZSgpXG4gICAgICAgICAgLnNsaWNlKDAsIDE2KX1gLFxuICAgIGRhdGE6ICFkYXRhVG9IYXNoID8gJ251bGwnIDogZGF0YVRvSGFzaCxcbiAgfTtcbn1cblxuZnVuY3Rpb24gZ2V0VURhdGFncmFtKHVybFBhdGg6IHN0cmluZywgZGF0YVRvSGFzaDogc3RyaW5nKSB7XG4gIGNvbnN0IEhFWDogQmluYXJ5VG9UZXh0RW5jb2RpbmcgPSAnaGV4JztcblxuICByZXR1cm4ge1xuICAgIFVEQVRBR1JBTTogYFVEQVRBR1JBTToke2NyZWF0ZUhhc2goJ3NoYTI1NicpXG4gICAgICAudXBkYXRlKFxuICAgICAgICBgJHtcbiAgICAgICAgICAhZGF0YVRvSGFzaFxuICAgICAgICAgICAgPyAnbnVsbCdcbiAgICAgICAgICAgIDogYERBVEE6JHtjcmVhdGVIYXNoKCdzaGEyNTYnKVxuICAgICAgICAgICAgICAgIC51cGRhdGUoSlNPTi5zdHJpbmdpZnkoZGF0YVRvSGFzaCkpXG4gICAgICAgICAgICAgICAgLmRpZ2VzdChIRVgpXG4gICAgICAgICAgICAgICAgLnRvVXBwZXJDYXNlKCl9YFxuICAgICAgICB9JHtcbiAgICAgICAgICAhdXJsUGF0aFxuICAgICAgICAgICAgPyAnbnVsbCdcbiAgICAgICAgICAgIDogYFVSTDoke2NyZWF0ZUhhc2goJ3NoYTI1NicpXG4gICAgICAgICAgICAgICAgLnVwZGF0ZSh1cmxQYXRoKVxuICAgICAgICAgICAgICAgIC5kaWdlc3QoSEVYKVxuICAgICAgICAgICAgICAgIC50b1VwcGVyQ2FzZSgpfWBcbiAgICAgICAgfWAsXG4gICAgICApXG4gICAgICAuZGlnZXN0KEhFWClcbiAgICAgIC50b1VwcGVyQ2FzZSgpXG4gICAgICAuc2xpY2UoMCwgMTUpfWAsXG4gIH07XG59XG5cbmZ1bmN0aW9uIGdldFVybEFuZERhdGFIYXNoZXMoXG4gIHVybFBhdGggPSAnJyxcbiAgZGF0YVRvQ2FjaGU/OiBhbnksXG4pOiBVcmxEYXRhQW5kSGFzaGVzIHtcbiAgLy8gY29uc3QgQkFTRTY0OiBCaW5hcnlUb1RleHRFbmNvZGluZyA9ICdiYXNlNjQnO1xuICBjb25zdCBIRVg6IEJpbmFyeVRvVGV4dEVuY29kaW5nID0gJ2hleCc7XG5cbiAgcmV0dXJuIHtcbiAgICBEQVRBX0hTSDogIWRhdGFUb0NhY2hlXG4gICAgICA/ICdudWxsJ1xuICAgICAgOiBgREFUQToke2NyZWF0ZUhhc2goJ3NoYTI1NicpXG4gICAgICAgICAgLnVwZGF0ZShKU09OLnN0cmluZ2lmeShkYXRhVG9DYWNoZSkpXG4gICAgICAgICAgLmRpZ2VzdChIRVgpXG4gICAgICAgICAgLnRvVXBwZXJDYXNlKClcbiAgICAgICAgICAuc2xpY2UoMCwgMTYpfWAsXG4gICAgVURBVEFHUkFNOiBgVURBVEFHUkFNOiR7Y3JlYXRlSGFzaCgnc2hhMjU2JylcbiAgICAgIC51cGRhdGUoXG4gICAgICAgIGAke1xuICAgICAgICAgICFkYXRhVG9DYWNoZVxuICAgICAgICAgICAgPyAnbnVsbCdcbiAgICAgICAgICAgIDogYERBVEE6JHtjcmVhdGVIYXNoKCdzaGEyNTYnKVxuICAgICAgICAgICAgICAgIC51cGRhdGUoSlNPTi5zdHJpbmdpZnkoZGF0YVRvQ2FjaGUpKVxuICAgICAgICAgICAgICAgIC5kaWdlc3QoSEVYKVxuICAgICAgICAgICAgICAgIC50b1VwcGVyQ2FzZSgpfWBcbiAgICAgICAgfSR7XG4gICAgICAgICAgIXVybFBhdGhcbiAgICAgICAgICAgID8gJ251bGwnXG4gICAgICAgICAgICA6IGBVUkw6JHtjcmVhdGVIYXNoKCdzaGEyNTYnKVxuICAgICAgICAgICAgICAgIC51cGRhdGUodXJsUGF0aClcbiAgICAgICAgICAgICAgICAuZGlnZXN0KEhFWClcbiAgICAgICAgICAgICAgICAudG9VcHBlckNhc2UoKX1gXG4gICAgICAgIH1gLFxuICAgICAgKVxuICAgICAgLmRpZ2VzdChIRVgpXG4gICAgICAudG9VcHBlckNhc2UoKVxuICAgICAgLnNsaWNlKDAsIDE1KX1gLFxuICAgIFVSTF9IU0g6ICF1cmxQYXRoXG4gICAgICA/ICdudWxsJ1xuICAgICAgOiBgVVJMOiR7Y3JlYXRlSGFzaCgnc2hhMjU2JylcbiAgICAgICAgICAudXBkYXRlKHVybFBhdGgpXG4gICAgICAgICAgLmRpZ2VzdChIRVgpXG4gICAgICAgICAgLnRvVXBwZXJDYXNlKClcbiAgICAgICAgICAuc2xpY2UoMCwgMTgpfWAsXG4gICAgZGF0YVRvQ2FjaGU6ICFkYXRhVG9DYWNoZSA/ICdudWxsJyA6IGRhdGFUb0NhY2hlLFxuICAgIHBhdGg6ICF1cmxQYXRoID8gJ251bGwnIDogdXJsUGF0aCxcbiAgfTtcbn1cblxuZXhwb3J0IHsgZ2V0RGF0YUhhc2gsIGdldFVEYXRhZ3JhbSwgZ2V0VXJsQW5kRGF0YUhhc2hlcywgZ2V0VXJsSGFzaCB9O1xuXG4vLyBkQVRBX0hBU0hfQjYyOiAhZGF0YVRvSGFzaFxuLy8gICA/ICdudWxsJ1xuLy8gICA6IGBEQVRBOkI2MiR7Y3JlYXRlSGFzaCgnc2hhMjU2Jylcbi8vICAgICAgIC51cGRhdGUoSlNPTi5zdHJpbmdpZnkoZGF0YVRvSGFzaCkpXG4vLyAgICAgICAuZGlnZXN0KEJBU0U2NClcbi8vICAgICAgIC5yZXBsYWNlQWxsKCcrJywgJycpXG4vLyAgICAgICAucmVwbGFjZUFsbCgnLycsICcnKVxuLy8gICAgICAgLnJlcGxhY2VBbGwoJz0nLCAnJylcbi8vICAgICAgIC5zbGljZSgwLCA4KX1gLFxuXG4vLyB1UkxfSEFTSF9CNjI6ICF1cmxQYXRoXG4vLyAgID8gJ251bGwnXG4vLyAgIDogYFVSTDpCNjI6JHtjcmVhdGVIYXNoKCdzaGEyNTYnKVxuLy8gICAgICAgLnVwZGF0ZSh1cmxQYXRoKVxuLy8gICAgICAgLmRpZ2VzdChCQVNFNjQpXG4vLyAgICAgICAucmVwbGFjZUFsbCgnKycsICcnKVxuLy8gICAgICAgLnJlcGxhY2VBbGwoJy8nLCAnJylcbi8vICAgICAgIC5yZXBsYWNlQWxsKCc9JywgJycpXG4vLyAgICAgICAuc2xpY2UoMCwgOCl9YCxcbiJdfQ==