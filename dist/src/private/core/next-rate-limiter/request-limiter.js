"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.newRequestLimiter = void 0;
const tslib_1 = require("tslib");
const requestPerSecondLimit_1 = require("../requestPerSecondLimit");
const queue_1 = require("./queue");
const newRequestLimiter = (options) => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
    const { httpClient, config, maxPerSec, maxPerHour } = options;
    // cb(fn(args));
    void httpClient, maxPerSec, maxPerHour;
    const callQueue = new queue_1.ApiCallQ_();
    const call = callQueue.addToQueue({ config, fn: httpClient });
    void call;
    return requestPerSecondLimit_1.limitingRequest((conf = config) => tslib_1.__awaiter(void 0, void 0, void 0, function* () { return httpClient(conf); }), 20);
});
exports.newRequestLimiter = newRequestLimiter;
// newRequestLimiter
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVxdWVzdC1saW1pdGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL3ByaXZhdGUvY29yZS9uZXh0LXJhdGUtbGltaXRlci9yZXF1ZXN0LWxpbWl0ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUVBLG9FQUEyRDtBQUMzRCxtQ0FBb0M7QUFFN0IsTUFBTSxpQkFBaUIsR0FBRyxDQUMvQixPQUEyQixFQUNGLEVBQUU7SUFDM0IsTUFBTSxFQUFFLFVBQVUsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxHQUFHLE9BQU8sQ0FBQztJQUU5RCxnQkFBZ0I7SUFDaEIsS0FBSyxVQUFVLEVBQUUsU0FBUyxFQUFFLFVBQVUsQ0FBQztJQUV2QyxNQUFNLFNBQVMsR0FBRyxJQUFJLGlCQUFTLEVBQUUsQ0FBQztJQUNsQyxNQUFNLElBQUksR0FBRyxTQUFTLENBQUMsVUFBVSxDQUFJLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxVQUFVLEVBQUUsQ0FBQyxDQUFDO0lBRWpFLEtBQUssSUFBSSxDQUFDO0lBRVYsT0FBTyx1Q0FBZSxDQUNwQixDQUFPLE9BQTRCLE1BQU0sRUFBRSxFQUFFLDBEQUFDLE9BQUEsVUFBVSxDQUFJLElBQUksQ0FBQyxDQUFBLEdBQUEsRUFDakUsRUFBRSxDQUNILENBQUM7QUFDSixDQUFDLENBQUEsQ0FBQztBQWpCVyxRQUFBLGlCQUFpQixxQkFpQjVCO0FBQ0Ysb0JBQW9CIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBDbGllbnRSZXF1ZXN0Q29uZmlnIH0gZnJvbSAnLi4vLi4vLi4vcmVzb3VyY2VzL3NpZGUtZWZmZWN0cy90eXBlcyc7XG5pbXBvcnQgdHlwZSB7IFJhdGVMaW1pdGVyT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uL3R5cGVzY3JpcHQnO1xuaW1wb3J0IHsgbGltaXRpbmdSZXF1ZXN0IH0gZnJvbSAnLi4vcmVxdWVzdFBlclNlY29uZExpbWl0JztcbmltcG9ydCB7IEFwaUNhbGxRXyB9IGZyb20gJy4vcXVldWUnO1xuXG5leHBvcnQgY29uc3QgbmV3UmVxdWVzdExpbWl0ZXIgPSBhc3luYyA8Uj4oXG4gIG9wdGlvbnM6IFJhdGVMaW1pdGVyT3B0aW9ucyxcbikgLyogOiBDbGllbnRQcm9taXNlPFI+ICovID0+IHtcbiAgY29uc3QgeyBodHRwQ2xpZW50LCBjb25maWcsIG1heFBlclNlYywgbWF4UGVySG91ciB9ID0gb3B0aW9ucztcblxuICAvLyBjYihmbihhcmdzKSk7XG4gIHZvaWQgaHR0cENsaWVudCwgbWF4UGVyU2VjLCBtYXhQZXJIb3VyO1xuXG4gIGNvbnN0IGNhbGxRdWV1ZSA9IG5ldyBBcGlDYWxsUV8oKTtcbiAgY29uc3QgY2FsbCA9IGNhbGxRdWV1ZS5hZGRUb1F1ZXVlPFI+KHsgY29uZmlnLCBmbjogaHR0cENsaWVudCB9KTtcblxuICB2b2lkIGNhbGw7XG5cbiAgcmV0dXJuIGxpbWl0aW5nUmVxdWVzdChcbiAgICBhc3luYyAoY29uZjogQ2xpZW50UmVxdWVzdENvbmZpZyA9IGNvbmZpZykgPT4gaHR0cENsaWVudDxSPihjb25mKSxcbiAgICAyMCxcbiAgKTtcbn07XG4vLyBuZXdSZXF1ZXN0TGltaXRlclxuIl19